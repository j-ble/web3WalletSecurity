#!/usr/bin/exec-suid -- /usr/local/bin/python -I

import os
import subprocess
import stat

# Create a dummy seed phrase
seed_phrase = "word one two three four five six seven eight nine ten eleven twelve"
obfuscated_file = "obfuscated_seed.txt"
seed_file = "my_seed.txt"

try:
    # 1. Create my_seed.txt
    with open(seed_file, "w") as f:
        f.write(seed_phrase)

    # 2. Obfuscate with tr (ROT13)
    with open(seed_file, "r") as infile, open(obfuscated_file, "w") as outfile:
        subprocess.run(["tr", "A-Za-z", "N-ZA-Mn-za-m"], stdin=infile, stdout=outfile)

    # 3. Set permissions
    os.chmod(obfuscated_file, stat.S_IRUSR | stat.S_IWUSR) # 600

    # 4. Verification
    file_stat = os.stat(obfuscated_file)
    permissions = file_stat.st_mode & 0o777

    if permissions == 0o600:
        with open("/flag") as f:
            print(f.read())
    else:
        print(f"Incorrect permissions on {obfuscated_file}. Expected 600, got {oct(permissions)[-3:]}")

except FileNotFoundError:
    print(f"Required file not found. Ensure {seed_file} and {obfuscated_file} are created correctly.")
except Exception as e:
    print(f"An error occurred: {e}")
